<div class="verification-status">
  <% case @status %>
  <% when "pending" %>
    <div class="status-indicator">
      <span class="status-badge pending">Under review</span>
      <h1>We're checking your documents</h1>
      <p>You'll hear from us in 1–2 business days</p>
    </div>
    
    <div class="status-details">
      <p>Our team is reviewing your submission. We'll email <strong><%= @identity.primary_email %></strong> when we're done.</p>
      
      <% if @latest_verification.present? %>
        <div class="meta">
          Submitted <%= time_ago_in_words(@latest_verification.created_at) %> ago
          <% if @latest_verification.respond_to?(:document_type) && @latest_verification.document_type.present? %>
            • <%= @latest_verification.document_type.titleize %>
          <% end %>
        </div>
      <% end %>
    </div>

  <% when "verified" %>
    <div class="status-indicator">
      <span class="status-badge verified">Verified</span>
      <h1><% if @identity.ysws_eligible %>You're all set for YSWS<% else %>You're verified<% end %></h1>
      <p><% if @identity.ysws_eligible %>You can now participate in programs and compete for prizes<% else %>Your account is verified and ready to go<% end %></p>
    </div>
    
    <% if @latest_verification.present? && @latest_verification.approved_at.present? %>
      <div class="status-details">
        <div class="meta">Verified <%= time_ago_in_words(@latest_verification.approved_at) %> ago</div>
      </div>
    <% end %>

    <div class="status-action">
      <%= link_to "Back to Home", root_path, class: "secondary", role: "button" %>
    </div>

  <% when "ineligible" %>
    <div class="status-indicator">
      <span class="status-badge rejected">Not eligible</span>
      <h1>
        <% if @latest_verification.present? && @latest_verification.rejected? && @latest_verification.fatal_rejection? %>
          Verification rejected
        <% elsif @identity.permabanned %>
          Account restricted
        <% else %>
          Unable to verify
        <% end %>
      </h1>
      <p>
        <% if @latest_verification.present? && @latest_verification.rejected? && @latest_verification.fatal_rejection? %>
          Your verification was permanently rejected
        <% elsif @identity.permabanned %>
          This account is not eligible for verification
        <% else %>
          You're not eligible for verification at this time
        <% end %>
      </p>
    </div>
    
    <% if @latest_verification.present? && @latest_verification.rejection_reason.present? %>
      <div class="status-details">
        <div class="rejection-info">
          <strong><%= @latest_verification.rejection_reason_name %></strong>
          <% if @latest_verification.rejection_reason_details.present? %>
            <br><%= @latest_verification.rejection_reason_details %>
          <% end %>
        </div>
      </div>
    <% end %>

    <div class="status-action">
      <p>Questions? Email <a href="mailto:bank@hackclub.com">bank@hackclub.com</a></p>
      <%= link_to "Back to Home", root_path, class: "secondary", role: "button" %>
    </div>

  <% when "needs_submission" %>
    <% if @identity.needs_resubmission? %>
      <div class="status-indicator">
        <span class="status-badge rejected">Needs resubmission</span>
        <h1>Please resubmit your documents</h1>
        <p>We found some issues with your previous submission that you can fix</p>
      </div>
      
      <div class="status-details">
        <p><strong>Issues to fix:</strong></p>
        <% @identity.rejected_verifications_needing_resubmission.each do |verification| %>
          <div class="rejection-info">
            <strong><%= verification.rejection_reason_name %></strong>
            <% if verification.rejection_reason_details.present? %>
              <%= verification.rejection_reason_details %>
            <% end %>
          </div>
        <% end %>
      </div>

      <div class="status-action">
        <%= link_to "Resubmit Documents", verification_step_path(:document), role: "button" %>
      </div>
    <% else %>
      <div class="status-indicator">
        <span class="status-badge none">Not started</span>
        <h1>Get verified for YSWS</h1>
        <p>Verify your age and identity to participate in programs and compete for prizes</p>
      </div>
      
      <div class="status-action">
        <%= link_to "Start Verification", verification_step_path(:document), role: "button" %>
      </div>
    <% end %>

  <% else %>
    <div class="status-indicator">
      <span class="status-badge none">Not started</span>
      <h1>Get verified for YSWS</h1>
      <p>Verify your age and identity to participate in programs and compete for prizes</p>
    </div>
    
    <div class="status-action">
      <%= link_to "Start Verification", verification_step_path(:document), role: "button" %>
    </div>
  <% end %>
</div>
